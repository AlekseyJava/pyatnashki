<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü—è—Ç–Ω–∞—à–∫–∏ - –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –≥–æ–ª–æ–≤–æ–ª–æ–º–∫–∞</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            color: #333;
            touch-action: manipulation;
        }

        .container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
            text-align: center;
            max-width: 500px;
            width: 100%;
        }

        h1 {
            color: #4a5568;
            margin-bottom: 15px;
            font-size: 2rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .game-info {
            display: flex;
            justify-content: space-around;
            margin: 15px 0;
            padding: 12px;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border-radius: 12px;
            color: white;
            font-size: 1rem;
        }

        .stat {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .stat span {
            font-weight: bold;
            font-size: 1.2rem;
        }

        .game-board {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
            gap: 3px;
            width: 100%;
            max-width: 400px;
            height: 300px;
            margin: 0 auto;
            background: #2d3748;
            padding: 4px;
            border-radius: 8px;
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.5);
            position: relative;
            touch-action: none;
        }

        .tile {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: bold;
            color: white;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 3px 5px rgba(0, 0, 0, 0.1);
            user-select: none;
            -webkit-user-select: none;
        }

        .tile:active {
            transform: scale(0.95);
        }

        .empty {
            background: transparent;
            box-shadow: none;
            cursor: default;
            visibility: hidden;
        }

        .controls {
            margin: 20px 0;
            display: flex;
            justify-content: center;
            gap: 12px;
            flex-wrap: wrap;
        }

        button {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            color: white;
            font-size: 0.9rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 3px 5px rgba(0, 0, 0, 0.1);
            min-width: 120px;
        }

        button:active {
            transform: translateY(1px);
            box-shadow: 0 2px 3px rgba(0, 0, 0, 0.1);
        }

        #shuffleBtn {
            background: linear-gradient(135deg, #ff9a9e 0%, #fad0c4 100%);
        }

        #solveBtn {
            background: linear-gradient(135deg, #a1c4fd 0%, #c2e9fb 100%);
        }

        .victory {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            color: white;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s ease;
            padding: 20px;
        }

        .victory.show {
            opacity: 1;
            pointer-events: all;
        }

        .victory h2 {
            font-size: 2rem;
            margin-bottom: 15px;
            color: #ffd700;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
            text-align: center;
        }

        .victory p {
            font-size: 1.2rem;
            margin-bottom: 20px;
            text-align: center;
        }

        .difficulty {
            margin: 12px 0;
            display: flex;
            justify-content: center;
            gap: 8px;
            flex-wrap: wrap;
        }

        .difficulty-btn {
            padding: 6px 12px;
            font-size: 0.8rem;
            min-width: 60px;
        }

        .instructions {
            margin-top: 20px;
            padding: 12px;
            background: rgba(0, 0, 0, 0.05);
            border-radius: 8px;
            text-align: left;
            font-size: 0.9rem;
        }

        .instructions h3 {
            color: #4a5568;
            margin-bottom: 8px;
            font-size: 1rem;
        }

        .instructions ul {
            list-style: none;
            padding: 0;
        }

        .instructions li {
            margin: 6px 0;
            padding-left: 20px;
            position: relative;
        }

        .instructions li:before {
            content: "‚û°Ô∏è";
            position: absolute;
            left: 0;
            font-size: 0.8rem;
        }

        .swipe-area {
            display: none;
        }

        .tile.moving {
            animation: moveTile 0.3s ease;
        }

        @keyframes moveTile {
            0% { transform: scale(1); }
            50% { transform: scale(0.9); }
            100% { transform: scale(1); }
        }

        .confetti {
            position: absolute;
            width: 8px;
            height: 8px;
            background: #ff0000;
            animation: fall linear forwards;
            z-index: 1001;
        }

        @keyframes fall {
            to {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }

        /* –ú–æ–±–∏–ª—å–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è */
        @media (max-width: 480px) {
            .container {
                padding: 15px;
                margin: 10px;
            }
            
            h1 {
                font-size: 1.7rem;
                margin-bottom: 12px;
            }
            
            .game-board {
                height: 250px;
                max-width: 300px;
            }
            
            .tile {
                font-size: 1.3rem;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
                gap: 10px;
            }
            
            button {
                width: 100%;
                max-width: 200px;
                padding: 12px;
            }
            
            .game-info {
                flex-direction: column;
                gap: 8px;
                padding: 10px;
            }
            
            .stat {
                flex-direction: row;
                justify-content: space-between;
                width: 100%;
            }
            
            .swipe-area {
                display: block;
                text-align: center;
                margin: 10px 0;
                font-size: 0.9rem;
                color: #4a5568;
                background: rgba(0, 0, 0, 0.05);
                padding: 8px;
                border-radius: 8px;
            }
        }

        @media (max-width: 350px) {
            .game-board {
                height: 220px;
                max-width: 260px;
            }
            
            .tile {
                font-size: 1.1rem;
            }
            
            h1 {
                font-size: 1.5rem;
            }
            
            .difficulty {
                flex-direction: column;
                align-items: center;
            }
            
            .difficulty-btn {
                width: 100%;
                max-width: 120px;
            }
        }

        /* –ü–ª–∞–Ω—à–µ—Ç—ã */
        @media (min-width: 768px) and (max-width: 1024px) {
            .game-board {
                height: 350px;
                max-width: 350px;
            }
            
            .tile {
                font-size: 1.8rem;
            }
        }

        /* –õ–∞–Ω–¥—à–∞—Ñ—Ç–Ω–∞—è –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è */
        @media (max-height: 500px) and (orientation: landscape) {
            .container {
                padding: 10px;
                margin: 5px;
            }
            
            .game-board {
                height: 200px;
                max-width: 200px;
            }
            
            .tile {
                font-size: 1rem;
            }
            
            .controls {
                margin: 10px 0;
            }
            
            .instructions {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéÆ –ü—è—Ç–Ω–∞—à–∫–∏</h1>
        
        <div class="game-info">
            <div class="stat">
                –•–æ–¥—ã: <span id="moves">0</span>
            </div>
            <div class="stat">
                –í—Ä–µ–º—è: <span id="timer">00:00</span>
            </div>
        </div>

        <div class="difficulty">
            <button class="difficulty-btn" onclick="setDifficulty(3)">3√ó3</button>
            <button class="difficulty-btn" onclick="setDifficulty(4)">4√ó4</button>
            <button class="difficulty-btn" onclick="setDifficulty(5)">5√ó5</button>
        </div>

        <div class="game-board" id="gameBoard">
            <!-- –ü–ª–∏—Ç–∫–∏ –±—É–¥—É—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã JavaScript -->
        </div>

        <div class="swipe-area">
            ‚¨ÖÔ∏è‚û°Ô∏è‚¨ÜÔ∏è‚¨áÔ∏è –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–≤–∞–π–ø—ã –¥–ª—è –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è –ø–ª–∏—Ç–æ–∫
        </div>

        <div class="controls">
            <button id="shuffleBtn">–ü–µ—Ä–µ–º–µ—à–∞—Ç—å</button>
            <button id="newGameBtn">–ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
            <button id="solveBtn">–†–µ—à–∏—Ç—å</button>
        </div>

        <div class="instructions">
            <h3>–ö–∞–∫ –∏–≥—Ä–∞—Ç—å:</h3>
            <ul>
                <li>–ö–ª–∏–∫–∞–π—Ç–µ –Ω–∞ –ø–ª–∏—Ç–∫–∏, —á—Ç–æ–±—ã –ø–µ—Ä–µ–º–µ—â–∞—Ç—å –∏—Ö –≤ –ø—É—Å—Ç–æ–µ –º–µ—Å—Ç–æ</li>
                <li>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–≤–∞–π–ø—ã –¥–ª—è –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è –ø–ª–∏—Ç–æ–∫ –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ</li>
                <li>–†–∞—Å–ø–æ–ª–æ–∂–∏—Ç–µ –ø–ª–∏—Ç–∫–∏ –≤ –ø–æ—Ä—è–¥–∫–µ –æ—Ç 1 –¥–æ 15</li>
                <li>–ü—É—Å—Ç–∞—è —è—á–µ–π–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤ –ø—Ä–∞–≤–æ–º –Ω–∏–∂–Ω–µ–º —É–≥–ª—É</li>
            </ul>
        </div>
    </div>

    <div class="victory" id="victoryScreen">
        <h2>üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!</h2>
        <p>–í—ã —Ä–µ—à–∏–ª–∏ –≥–æ–ª–æ–≤–æ–ª–æ–º–∫—É!</p>
        <p>–•–æ–¥–æ–≤: <span id="finalMoves">0</span></p>
        <p>–í—Ä–µ–º—è: <span id="finalTime">00:00</span></p>
        <button onclick="hideVictory()">–ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞</button>
    </div>

    <script>
        class Game15 {
            constructor() {
                this.gameBoard = document.getElementById('gameBoard');
                this.movesElement = document.getElementById('moves');
                this.timerElement = document.getElementById('timer');
                this.victoryScreen = document.getElementById('victoryScreen');
                this.finalMovesElement = document.getElementById('finalMoves');
                this.finalTimeElement = document.getElementById('finalTime');
                
                this.boardSize = 4;
                this.board = [];
                this.emptyPos = { row: 0, col: 0 };
                this.moves = 0;
                this.timer = 0;
                this.timerInterval = null;
                this.gameStarted = false;
                this.touchStartX = 0;
                this.touchStartY = 0;
                
                this.init();
                this.setupEventListeners();
            }
            
            init() {
                this.stopTimer();
                this.moves = 0;
                this.timer = 0;
                this.gameStarted = false;
                this.updateUI();
                
                this.createBoard();
                this.renderBoard();
            }
            
            createBoard() {
                this.board = [];
                let counter = 1;
                
                for (let i = 0; i < this.boardSize; i++) {
                    this.board[i] = [];
                    for (let j = 0; j < this.boardSize; j++) {
                        if (i === this.boardSize - 1 && j === this.boardSize - 1) {
                            this.board[i][j] = 0;
                            this.emptyPos = { row: i, col: j };
                        } else {
                            this.board[i][j] = counter++;
                        }
                    }
                }
            }
            
            renderBoard() {
                this.gameBoard.innerHTML = '';
                this.gameBoard.style.gridTemplateColumns = `repeat(${this.boardSize}, 1fr)`;
                this.gameBoard.style.gridTemplateRows = `repeat(${this.boardSize}, 1fr)`;
                
                for (let i = 0; i < this.boardSize; i++) {
                    for (let j = 0; j < this.boardSize; j++) {
                        const value = this.board[i][j];
                        const tile = document.createElement('div');
                        
                        if (value === 0) {
                            tile.className = 'tile empty';
                            tile.innerHTML = '';
                        } else {
                            tile.className = 'tile';
                            tile.innerHTML = value;
                            tile.dataset.row = i;
                            tile.dataset.col = j;
                            
                            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
                            tile.addEventListener('touchstart', (e) => {
                                e.preventDefault();
                                const row = parseInt(e.target.dataset.row);
                                const col = parseInt(e.target.dataset.col);
                                this.moveTile(row, col);
                            });
                            
                            tile.addEventListener('click', (e) => {
                                const row = parseInt(e.target.dataset.row);
                                const col = parseInt(e.target.dataset.col);
                                this.moveTile(row, col);
                            });
                        }
                        
                        this.gameBoard.appendChild(tile);
                    }
                }
            }
            
            moveTile(row, col) {
                if (!this.isValidMove(row, col)) return;
                
                if (!this.gameStarted) {
                    this.startTimer();
                    this.gameStarted = true;
                }
                
                // –ê–Ω–∏–º–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è
                const tile = this.gameBoard.querySelector(`[data-row="${row}"][data-col="${col}"]`);
                if (tile) {
                    tile.classList.add('moving');
                    setTimeout(() => tile.classList.remove('moving'), 300);
                }
                
                // –û–±–º–µ–Ω –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
                this.board[this.emptyPos.row][this.emptyPos.col] = this.board[row][col];
                this.board[row][col] = 0;
                this.emptyPos = { row, col };
                
                this.moves++;
                this.updateUI();
                this.renderBoard();
                
                if (this.checkWin()) {
                    this.endGame();
                }
            }
            
            isValidMove(row, col) {
                const rowDiff = Math.abs(row - this.emptyPos.row);
                const colDiff = Math.abs(col - this.emptyPos.col);
                
                return (rowDiff === 1 && colDiff === 0) || (rowDiff === 0 && colDiff === 1);
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞, —Ä–µ—à–∞–µ–º–∞ –ª–∏ –≥–æ–ª–æ–≤–æ–ª–æ–º–∫–∞
            isSolvable() {
                // –î–ª—è –≥–æ–ª–æ–≤–æ–ª–æ–º–∫–∏ 15 –Ω—É–∂–Ω–æ –ø–æ—Å—á–∏—Ç–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–Ω–≤–µ—Ä—Å–∏–π
                let inversions = 0;
                const flatBoard = this.board.flat().filter(num => num !== 0);
                
                for (let i = 0; i < flatBoard.length; i++) {
                    for (let j = i + 1; j < flatBoard.length; j++) {
                        if (flatBoard[i] > flatBoard[j]) {
                            inversions++;
                        }
                    }
                }
                
                // –î–ª—è –≥–æ–ª–æ–≤–æ–ª–æ–º–∫–∏ —Å —á–µ—Ç–Ω—ã–º —Ä–∞–∑–º–µ—Ä–æ–º (4x4) –Ω—É–∂–Ω–æ —É—á–µ—Å—Ç—å –ø–æ–ª–æ–∂–µ–Ω–∏–µ –ø—É—Å—Ç–æ–π –∫–ª–µ—Ç–∫–∏
                if (this.boardSize % 2 === 0) {
                    // –ü—É—Å—Ç–∞—è –∫–ª–µ—Ç–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –Ω–∞ —á–µ—Ç–Ω–æ–π —Å—Ç—Ä–æ–∫–µ —Å–Ω–∏–∑—É (—Å—á–∏—Ç–∞—è —Å 1)
                    const emptyRowFromBottom = this.boardSize - this.emptyPos.row;
                    return (emptyRowFromBottom % 2 === 0) === (inversions % 2 === 1);
                } else {
                    // –î–ª—è –Ω–µ—á–µ—Ç–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–Ω–≤–µ—Ä—Å–∏–π –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —á–µ—Ç–Ω—ã–º
                    return inversions % 2 === 0;
                }
            }
            
            shuffleBoard() {
                if (!this.gameStarted) {
                    this.startTimer();
                    this.gameStarted = true;
                }
                
                // –°–æ–≤–µ—Ä—à–∞–µ–º –º–Ω–æ–≥–æ —Å–ª—É—á–∞–π–Ω—ã—Ö —Ö–æ–¥–æ–≤, –ø–æ–∫–∞ –Ω–µ –ø–æ–ª—É—á–∏–º —Ä–µ—à–∞–µ–º—É—é –∫–æ–º–±–∏–Ω–∞—Ü–∏—é
                let attempts = 0;
                do {
                    // –°–æ–≤–µ—Ä—à–∞–µ–º –º–Ω–æ–≥–æ —Å–ª—É—á–∞–π–Ω—ã—Ö —Ö–æ–¥–æ–≤
                    const directions = [
                        { row: -1, col: 0 }, // –≤–≤–µ—Ä—Ö
                        { row: 1, col: 0 },  // –≤–Ω–∏–∑
                        { row: 0, col: -1 }, // –≤–ª–µ–≤–æ
                        { row: 0, col: 1 }   // –≤–ø—Ä–∞–≤–æ
                    ];
                    
                    for (let i = 0; i < 1000; i++) {
                        const validMoves = directions.filter(dir => {
                            const newRow = this.emptyPos.row + dir.row;
                            const newCol = this.emptyPos.col + dir.col;
                            return newRow >= 0 && newRow < this.boardSize && 
                                   newCol >= 0 && newCol < this.boardSize;
                        });
                        
                        if (validMoves.length > 0) {
                            const randomMove = validMoves[Math.floor(Math.random() * validMoves.length)];
                            const newRow = this.emptyPos.row + randomMove.row;
                            const newCol = this.emptyPos.col + randomMove.col;
                            
                            // –ü–µ—Ä–µ–º–µ—â–∞–µ–º –ø–ª–∏—Ç–∫—É
                            this.board[this.emptyPos.row][this.emptyPos.col] = this.board[newRow][newCol];
                            this.board[newRow][newCol] = 0;
                            this.emptyPos = { row: newRow, col: newCol };
                        }
                    }
                    attempts++;
                    
                    // –ó–∞—â–∏—Ç–∞ –æ—Ç –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–≥–æ —Ü–∏–∫–ª–∞
                    if (attempts > 100) {
                        // –ï—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å —Ä–µ—à–∞–µ–º—É—é –∫–æ–º–±–∏–Ω–∞—Ü–∏—é, —Å–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é –¥–æ—Å–∫—É
                        this.createBoard();
                        attempts = 0;
                    }
                } while (this.checkWin() || !this.isSolvable());
                
                this.moves = 0;
                this.updateUI();
                this.renderBoard();
            }
            
            checkWin() {
                let counter = 1;
                for (let i = 0; i < this.boardSize; i++) {
                    for (let j = 0; j < this.boardSize; j++) {
                        if (i === this.boardSize - 1 && j === this.boardSize - 1) {
                            if (this.board[i][j] !== 0) return false;
                        } else {
                            if (this.board[i][j] !== counter++) return false;
                        }
                    }
                }
                return true;
            }
            
            updateUI() {
                this.movesElement.textContent = this.moves;
                
                const minutes = Math.floor(this.timer / 60);
                const seconds = this.timer % 60;
                this.timerElement.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }
            
            startTimer() {
                this.stopTimer();
                this.timerInterval = setInterval(() => {
                    this.timer++;
                    this.updateUI();
                }, 1000);
            }
            
            stopTimer() {
                if (this.timerInterval) {
                    clearInterval(this.timerInterval);
                    this.timerInterval = null;
                }
            }
            
            endGame() {
                this.stopTimer();
                this.finalMovesElement.textContent = this.moves;
                this.finalTimeElement.textContent = this.timerElement.textContent;
                this.victoryScreen.classList.add('show');
                this.createConfetti();
            }
            
            createConfetti() {
                const colors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff', '#00ffff'];
                
                for (let i = 0; i < 100; i++) {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + 'vw';
                    confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.animationDuration = (Math.random() * 3 + 2) + 's';
                    document.body.appendChild(confetti);
                    
                    setTimeout(() => {
                        if (confetti.parentNode) {
                            document.body.removeChild(confetti);
                        }
                    }, 5000);
                }
            }
            
            solvePuzzle() {
                if (!this.gameStarted) {
                    this.startTimer();
                    this.gameStarted = true;
                }
                
                // –ü—Ä–æ—Å—Ç–æ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–µ—à–µ–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
                this.createBoard();
                this.renderBoard();
                this.moves = 0;
                this.updateUI();
                this.endGame();
            }
            
            setDifficulty(size) {
                this.boardSize = size;
                this.init();
            }
            
            handleSwipe(direction) {
                if (!this.gameStarted) {
                    this.startTimer();
                    this.gameStarted = true;
                }
                
                let moveRow = this.emptyPos.row;
                let moveCol = this.emptyPos.col;
                
                switch(direction) {
                    case 'up':
                        moveRow++;
                        break;
                    case 'down':
                        moveRow--;
                        break;
                    case 'left':
                        moveCol++;
                        break;
                    case 'right':
                        moveCol--;
                        break;
                    default:
                        return;
                }
                
                if (moveRow >= 0 && moveRow < this.boardSize && moveCol >= 0 && moveCol < this.boardSize) {
                    this.moveTile(moveRow, moveCol);
                }
            }
            
            setupEventListeners() {
                document.getElementById('shuffleBtn').addEventListener('click', () => this.shuffleBoard());
                document.getElementById('newGameBtn').addEventListener('click', () => this.init());
                document.getElementById('solveBtn').addEventListener('click', () => this.solvePuzzle());
                
                // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
                document.addEventListener('keydown', (e) => {
                    if (!this.gameStarted) {
                        this.startTimer();
                        this.gameStarted = true;
                    }
                    
                    let moveRow = this.emptyPos.row;
                    let moveCol = this.emptyPos.col;
                    
                    switch(e.key) {
                        case 'ArrowUp':
                            moveRow++;
                            break;
                        case 'ArrowDown':
                            moveRow--;
                            break;
                        case 'ArrowLeft':
                            moveCol++;
                            break;
                        case 'ArrowRight':
                            moveCol--;
                            break;
                        default:
                            return;
                    }
                    
                    if (moveRow >= 0 && moveRow < this.boardSize && moveCol >= 0 && moveCol < this.boardSize) {
                        this.moveTile(moveRow, moveCol);
                    }
                });
                
                // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–≤–∞–π–ø–æ–≤ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
                let touchStartX = 0;
                let touchStartY = 0;
                
                this.gameBoard.addEventListener('touchstart', (e) => {
                    touchStartX = e.touches[0].clientX;
                    touchStartY = e.touches[0].clientY;
                    e.preventDefault();
                }, { passive: false });
                
                this.gameBoard.addEventListener('touchend', (e) => {
                    const touchEndX = e.changedTouches[0].clientX;
                    const touchEndY = e.changedTouches[0].clientY;
                    
                    const diffX = touchEndX - touchStartX;
                    const diffY = touchEndY - touchStartY;
                    
                    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–≤–∞–π–ø–∞
                    if (Math.abs(diffX) > Math.abs(diffY)) {
                        // –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π —Å–≤–∞–π–ø
                        if (Math.abs(diffX) > 30) { // –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–∏—Å—Ç–∞–Ω—Ü–∏—è —Å–≤–∞–π–ø–∞
                            if (diffX > 0) {
                                this.handleSwipe('right');
                            } else {
                                this.handleSwipe('left');
                            }
                        }
                    } else {
                        // –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π —Å–≤–∞–π–ø
                        if (Math.abs(diffY) > 30) { // –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–∏—Å—Ç–∞–Ω—Ü–∏—è —Å–≤–∞–π–ø–∞
                            if (diffY > 0) {
                                this.handleSwipe('down');
                            } else {
                                this.handleSwipe('up');
                            }
                        }
                    }
                    
                    e.preventDefault();
                }, { passive: false });
            }
        }
        
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫
        function setDifficulty(size) {
            game.setDifficulty(size);
        }
        
        function hideVictory() {
            document.getElementById('victoryScreen').classList.remove('show');
            game.init();
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        const game = new Game15();
    </script>
</body>
</html>